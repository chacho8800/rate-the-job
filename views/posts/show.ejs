<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/stylesheets/partials.css" />
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <title><%= post.title %></title>
</head>
<body>
    <%- include('../partials/_navbar.ejs') %>
    <h1>Post Page</h1>
    <ul>
        <li><strong>Title:</strong><%= post.title %></li>
        <li><strong>Description:</strong><%= post.description %></li>
        <li><strong>Category:</strong><%= post.category %></li>
        <li><strong>Image:</strong><img src="<%= post.img %>" alt="postImg" style="max-width: 30%; height: auto;" ></li>
        
    </ul>
    <% if (post.owner.profileId) { %>
        <div>
            <p>Listed By</p>
            <p><strong>Name:</strong><%= post.owner.profileId.firstName %> <%= post.owner.profileId.lastName %></p>
            <p><strong>Company:</strong> <%= post.owner.profileId.company %></p>
            <p><strong>Experience:</strong> <%= post.owner.profileId.experience %></p>
        </div>
    <% } else { %>
        <p>No profile information available.</p>
    <% } %>

    <form action="/users/<%= user._id %>/posts/<%= post._id %>/reviews" method="POST">
        <label for="rating">Rating:</label>
        <select name="rating" id="rating" required>
            <option value="1">⭐</option>
            <option value="2">⭐⭐</option>
            <option value="3">⭐⭐⭐</option>
            <option value="4">⭐⭐⭐⭐</option>
            <option value="5">⭐⭐⭐⭐⭐</option>
        </select>

        <br>

        <label for="comment">Comment:</label>
        <textarea name="comment" id="comment" rows="3" cols="30"></textarea>

        <br>
        <button type="submit">Submit Review</button>
    </form>

    <% post.reviews.forEach(review => { %>
        <li>
          <%= "⭐".repeat(review.rating) %> — 
          <strong><%= review.reviewerId.username %></strong>: 
          <%= review.comment %><br>
          <small>Posted on <%= new Date(review.createdAt).toLocaleDateString() %></small>
        </li>
    <% }) %>

   
    <a href="/users/<%= user._id %>/posts">Back to Post App</a>
</body>
</html>